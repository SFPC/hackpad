<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Language" content="en-us" />
<meta name="version" content="772"/>
<style>body {font-family:Helvetica}ul.comment{list-style-image:url('https://hackpad.com/static/img/comment.png');} ul.task{list-style-image:url('https://hackpad.com/static/img/unchecked.png');}ul.taskdone{list-style-image:url('https://hackpad.com/static/img/checked.png');} </style><title>/3668$rY9OLBPBsJx</title>
</head>
<body><h1>Question about Python</h1><p></p><p>Sharing an ongoing conversation with Zach about Python for parsing, sorting data:</p><p></p><p>I&rsquo;m now working with the raw data from ingredients to find pattern of shared compounds.</p><p></p><p>Here is my question:</p><p>as you can see in the attached file I have a csv with 2 columns, ingredients id and compounds id.</p><p>Ingredients that contain more than one compounds are repeated several times.</p><p>I&rsquo;d like to find out the ingredients that are repeated the most (the most frequent ==&gt; ingredients with a lot of compounds) and sort my list from &quot;most repeated ingredients&quot; to &quot;least repeated ingredients&quot;. (of course I want to keep the compounds info as well next to ingredient id)</p><p></p><p>So far my understanding is: I need to create a dictionary from the csv, and look for repeated ingredients and eventually sort them.</p><ul class="comment"><li>see below, I think you need a<u> dictionary of sets</u> (your ingredients are the key in the dictionary, the sets are the value which are a unique list of compounds per ingredient)</li></ul>

<p>Here is where I am stuck with the code, any tip/suggestion?</p><p></p><p>here is the link with Python code + data set:</p><p><a href="https://www.dropbox.com/sh/kvy8y5w1hoj1q25/kkQpG0t1jS"></a>https://www.dropbox.com/sh/kvy8y5w1hoj1q25/kkQpG0t1jS</p><p></p><ul><li>import_ingredients_compounds_b (python script)</li>
<li>ingr_comp.csv (csv file with relationship between ingredients id and compounds id, if an ingredient contains more than a compound it is repeated)</li>
<li>ingr_info_b.csv (csv file with ingredients id and correspondent ingredient name)</li>
<li>comp_info.tsv (tsv file with compounds id and correspondent compound name)</li></ul>

<p>//------------------------------------------------</p><p></p><p>I think the best way to do this is via a map (key value pair) -- here&rsquo;s a small example that counts the compounds per ingredient and reports them in numerical order:&nbsp;</p><p></p><p><a href="http://pastebin.com/m0D3JgyS"></a><a href='http://pastebin.com/m0D3JgyS'/>http://pastebin.com/m0D3JgyS</a></p><p></p><p>I really like the collection.counter object for this:&nbsp;</p><p></p><ul style="list-style: none;"><li><i>A Counter is a dict[ionary] subclass for counting hashable objects. It is an unordered collection where elements are stored as dictionary keys and their counts are stored as dictionary values.&nbsp;</i></li></ul>

<p>the heart of this code is here -- think of ingredients as a key value map, where you can access the array by name not integer...&nbsp;&nbsp;</p><p></p><ul class="code"><li>ingredients[row[&rsquo;ingredient id&rsquo;]] += 1</li></ul>

<p>key value stores are basically like:&nbsp;</p><p></p><ul class="code"><li>ingredients[205] = 124;</li></ul>

<p>where &quot;205&quot; isn&rsquo;t the position in the array (!!!), but actually a unique identifier (and in this case, the 124 is the count).&nbsp; here&rsquo;s a p5 example which might be easier to understand:&nbsp;</p><p></p><p><a href="http://processing.org/reference/HashMap.html"></a><a href='http://processing.org/reference/HashMap.html'/>http://processing.org/reference/HashMap.html</a></p><p></p><p>for trying to wrap your head around hashes.&nbsp; for counting, this is really useful idea.&nbsp; what I like is the &quot;most common&quot; function, which prints out things like:&nbsp;</p><p></p><ul class="code"><li>print ingredients.most_common(10)</li></ul>

<ul class="code"><li>[(&rsquo;908&rsquo;, 239), (&rsquo;631&rsquo;, 234), (&rsquo;506&rsquo;, 230), (&rsquo;1495&rsquo;, 227), (&rsquo;1428&rsquo;, 222), (&rsquo;360&rsquo;, 217), (&rsquo;258&rsquo;, 216), (&rsquo;625&rsquo;, 206), (&rsquo;958&rsquo;, 204), (&rsquo;248&rsquo;, 199)]</li></ul>

<p>this is the 10 ingredients that have the most compounds associated with them.&nbsp;</p><p></p><p>the next step is to build a dictionary as well as we parse, and use the results of this counter to look up from the dictionary.&nbsp;</p><p></p><p>for a data structure what I think you really want is a <b>dictionary of sets</b>.&nbsp; a set is like an array but where each object is unique, in your case, your compound for each ingedient is unique, and each ingedient needs to have more then one compound.&nbsp;</p><p></p><p>googling, I got to this:&nbsp;</p><p></p><p><a href="http://stackoverflow.com/questions/2285874/python-dictionary-that-maps-strings-to-a-set-of-strings/2285881#2285881"></a><a href='http://stackoverflow.com/questions/2285874/python-dictionary-that-maps-strings-to-a-set-of-strings/2285881#2285881'/>http://stackoverflow.com/questions/2285874/python-dictionary-that-maps-strings-to-a-set-of-strings/2285881#2285881</a></p><p></p><p>I implemented this,&nbsp;</p><p></p><p><a href="http://pastebin.com/P1Z1K6Pt"></a><a href='http://pastebin.com/P1Z1K6Pt'/>http://pastebin.com/P1Z1K6Pt</a></p><p></p><p>which&nbsp;</p><p></p><p>(a) prints out the top ten ingredients</p><p>(b) for each top ten ingredients, prints out the set associated with it (all the unique compounds it has)</p><p></p><p>output looks like:&nbsp;</p><p>[(&rsquo;908&rsquo;, 239), (&rsquo;631&rsquo;, 234), (&rsquo;506&rsquo;, 230), (&rsquo;1495&rsquo;, 227), (&rsquo;1428&rsquo;, 222), (&rsquo;360&rsquo;, 217), (&rsquo;258&rsquo;, 216), (&rsquo;625&rsquo;, 206), (&rsquo;958&rsquo;, 204), (&rsquo;248&rsquo;, 199)]</p><p></p><p>908</p><p>set([&rsquo; 609&rsquo;, &rsquo; 58&rsquo;, &rsquo; 786&rsquo;, &rsquo; 784&rsquo;, &rsquo; 196&rsquo;, &rsquo; 292&rsquo;, &rsquo; 50&rsquo;, &rsquo; 52&rsquo;, &rsquo; 554&rsquo;, &rsquo; 822&rsquo;, &rsquo; 1007&rsquo;, &rsquo; 1004&rsquo;, &rsquo; 1005&rsquo;, &rsquo; 826&rsquo;, &rsquo; 827&rsquo;, &rsquo; 1084&rsquo;, &rsquo; 578&rsquo;, &rsquo; 1080&rsquo;, &rsquo; 577&rsquo;, &rsquo; 628&rsquo;, &rsquo; 573&rsquo;, &rsquo; 275&rsquo;, &rsquo; 397&rsquo;, &rsquo; 273&rsquo;, &rsquo; 925&rsquo;, &rsquo; 170&rsquo;, &rsquo; 173&rsquo;, &rsquo; 174&rsquo;, &rsquo; 943&rsquo;, &rsquo; 177&rsquo;, &rsquo; 836&rsquo;, &rsquo; 945&rsquo;, &rsquo; 400&rsquo;, &rsquo; 737&rsquo;, &rsquo; 0&rsquo;, &rsquo; 1&rsquo;, &rsquo; 6&rsquo;, &rsquo; 1092&rsquo;, &rsquo; 1033&rsquo;, &rsquo; 8&rsquo;, &rsquo; 369&rsquo;, &rsquo; 777&rsquo;, &rsquo; 565&rsquo;, &rsquo; 243&rsquo;, &rsquo; 247&rsquo;, &rsquo; 163&rsquo;, &rsquo; 481&rsquo;, &rsquo; 249&rsquo;, &rsquo; 164&rsquo;, &rsquo; 841&rsquo;, &rsquo; 846&rsquo;, &rsquo; 847&rsquo;, &rsquo; 848&rsquo;, &rsquo; 580&rsquo;, &rsquo; 1101&rsquo;, &rsquo; 413&rsquo;, &rsquo; 720&rsquo;, &rsquo; 1078&rsquo;, &rsquo; 689&rsquo;, &rsquo; 724&rsquo;, &rsquo; 415&rsquo;, &rsquo; 1100&rsquo;, &rsquo; 682&rsquo;, &rsquo; 857&rsquo;, &rsquo; 680&rsquo;, &rsquo; 922&rsquo;, &rsquo; 600&rsquo;, &rsquo; 559&rsquo;, &rsquo; 606&rsquo;, &rsquo; 1002&rsquo;, &rsquo; 550&rsquo;, &rsquo; 317&rsquo;, &rsquo; 556&rsquo;, &rsquo; 311&rsquo;, &rsquo; 158&rsquo;, &rsquo; 159&rsquo;, &rsquo; 63&rsquo;, &rsquo; 62&rsquo;, &rsquo; 390&rsquo;, &rsquo; 391&rsquo;, &rsquo; 67&rsquo;, &rsquo; 69&rsquo;, &rsquo; 398&rsquo;, &rsquo; 954&rsquo;, &rsquo; 995&rsquo;, &rsquo; 697&rsquo;, &rsquo; 691&rsquo;, &rsquo; 690&rsquo;, &rsquo; 693&rsquo;, &rsquo; 858&rsquo;, &rsquo; 541&rsquo;, &rsquo; 540&rsquo;, &rsquo; 912&rsquo;, &rsquo; 1089&rsquo;, &rsquo; 424&rsquo;, &rsquo; 911&rsquo;, &rsquo; 549&rsquo;, &rsquo; 423&rsquo;, &rsquo; 756&rsquo;, &rsquo; 996&rsquo;, &rsquo; 994&rsquo;, &rsquo; 753&rsquo;, &rsquo; 893&rsquo;, &rsquo; 616&rsquo;, &rsquo; 611&rsquo;, &rsquo; 610&rsquo;, &rsquo; 387&rsquo;, &rsquo; 229&rsquo;, &rsquo; 75&rsquo;, &rsquo; 380&rsquo;, &rsquo; 220&rsquo;, &rsquo; 223&rsquo;, &rsquo; 224&rsquo;, &rsquo; 227&rsquo;, &rsquo; 963&rsquo;, &rsquo; 1040&rsquo;, &rsquo; 657&rsquo;, &rsquo; 17&rsquo;, &rsquo; 19&rsquo;, &rsquo; 909&rsquo;, &rsquo; 442&rsquo;, &rsquo; 308&rsquo;, &rsquo; 439&rsquo;, &rsquo; 426&rsquo;, &rsquo; 1055&rsquo;, &rsquo; 427&rsquo;, &rsquo; 704&rsquo;, &rsquo; 435&rsquo;, &rsquo; 985&rsquo;, &rsquo; 1023&rsquo;, &rsquo; 1104&rsquo;, &rsquo; 980&rsquo;, &rsquo; 667&rsquo;, &rsquo; 136&rsquo;, &rsquo; 1013&rsquo;, &rsquo; 139&rsquo;, &rsquo; 235&rsquo;, &rsquo; 971&rsquo;, &rsquo; 20&rsquo;, &rsquo; 1079&rsquo;, &rsquo; 22&rsquo;, &rsquo; 978&rsquo;, &rsquo; 875&rsquo;, &rsquo; 990&rsquo;, &rsquo; 521&rsquo;, &rsquo; 326&rsquo;, &rsquo; 288&rsquo;, &rsquo; 524&rsquo;, &rsquo; 345&rsquo;, &rsquo; 1091&rsquo;, &rsquo; 282&rsquo;, &rsquo; 283&rsquo;, &rsquo; 772&rsquo;, &rsquo; 771&rsquo;, &rsquo; 203&rsquo;, &rsquo; 775&rsquo;, &rsquo; 673&rsquo;, &rsquo; 445&rsquo;, &rsquo; 670&rsquo;, &rsquo; 440&rsquo;, &rsquo; 676&rsquo;, &rsquo; 675&rsquo;, &rsquo; 209&rsquo;, &rsquo; 127&rsquo;, &rsquo; 126&rsquo;, &rsquo; 548&rsquo;, &rsquo; 410&rsquo;, &rsquo; 519&rsquo;, &rsquo; 121&rsquo;, &rsquo; 90&rsquo;, &rsquo; 91&rsquo;, &rsquo; 93&rsquo;, &rsquo; 95&rsquo;, &rsquo; 1102&rsquo;, &rsquo; 1068&rsquo;, &rsquo; 1069&rsquo;, &rsquo; 961&rsquo;, &rsquo; 929&rsquo;, &rsquo; 33&rsquo;, &rsquo; 928&rsquo;, &rsquo; 1064&rsquo;, &rsquo; 37&rsquo;, &rsquo; 1082&rsquo;, &rsquo; 299&rsquo;, &rsquo; 298&rsquo;, &rsquo; 645&rsquo;, &rsquo; 357&rsquo;, &rsquo; 517&rsquo;, &rsquo; 806&rsquo;, &rsquo; 807&rsquo;, &rsquo; 800&rsquo;, &rsquo; 294&rsquo;, &rsquo; 211&rsquo;, &rsquo; 885&rsquo;, &rsquo; 198&rsquo;, &rsquo; 595&rsquo;, &rsquo; 215&rsquo;, &rsquo; 764&rsquo;, &rsquo; 767&rsquo;, &rsquo; 766&rsquo;, &rsquo; 761&rsquo;, &rsquo; 599&rsquo;, &rsquo; 384&rsquo;, &rsquo; 116&rsquo;, &rsquo; 115&rsquo;, &rsquo; 118&rsquo;, &rsquo; 884&rsquo;, &rsquo; 793&rsquo;, &rsquo; 794&rsquo;, &rsquo; 958&rsquo;, &rsquo; 798&rsquo;, &rsquo; 957&rsquo;, &rsquo; 45&rsquo;, &rsquo; 886&rsquo;, &rsquo; 184&rsquo;, &rsquo; 340&rsquo;, &rsquo; 346&rsquo;, &rsquo; 183&rsquo;, &rsquo; 1015&rsquo;, &rsquo; 658&rsquo;, &rsquo; 813&rsquo;, &rsquo; 811&rsquo;, &rsquo; 1095&rsquo;, &rsquo; 896&rsquo;, &rsquo; 895&rsquo;, &rsquo; 585&rsquo;, &rsquo; 584&rsquo;, &rsquo; 890&rsquo;, &rsquo; 462&rsquo;, &rsquo; 460&rsquo;, &rsquo; 466&rsquo;, &rsquo; 734&rsquo;, &rsquo; 716&rsquo;, &rsquo; 717&rsquo;, &rsquo; 735&rsquo;, &rsquo; 927&rsquo;, &rsquo; 107&rsquo;, &rsquo; 269&rsquo;, &rsquo; 103&rsquo;])</p><p></p><p>this means, for ingredient 908 here are the compounds listed as a set.&nbsp; you should notice the set is unsorted, but it&rsquo;s also <b>unique</b> which means that if a compound appears multiple times for an ingredient it wont appear in this list.</p><p></p><p>there&rsquo;s **great** property of sets which is if you want to see what compounds two sets have in common, for example, take two sets and compute the union / intersection, etc:&nbsp;</p><p></p><p><a href="http://docs.python.org/2/library/sets.html"></a><a href='http://docs.python.org/2/library/sets.html'/>http://docs.python.org/2/library/sets.html</a></p><p></p><p>(see 8.7.2. Example)&nbsp;</p><p></p><p>I hope this helps</p><p></p><p>(side note, here&rsquo;s a nice counting example in python for word frequency: <a href="https://gist.github.com/bradmontgomery/4717521"></a><a href='https://gist.github.com/bradmontgomery/4717521'/>https://gist.github.com/bradmontgomery/4717521</a>&nbsp; and this is a nice explanation of operations on sets, which can be useful for figuring out how much commonality, difference etc there are between sets:&nbsp;</p><p><a href="https://www.khanacademy.org/math/probability/independent-dependent-probability/basic_set_operations/v/intersection-and-union-of-sets)"></a>https://www.khanacademy.org/math/probability/independent-dependent-probability/basic_set_operations/v/intersection-and-union-of-sets)</p><p></p><p>//------------------------------------------------</p><p></p><p></p></body>
</html>
